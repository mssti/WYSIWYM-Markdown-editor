<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.5.xsd">
	<header>
		<license><![CDATA[http://opensource.org/licenses/gpl-license.php GNU General Public License v2]]></license>
		
		<title lang="en"><![CDATA[WYSIWYM Markdown editor : upgrade to 1.0.1]]></title>

		<description lang="en"><![CDATA[This file provides instructions for upgrade WYSIWYM MOD from version 1.0.0 to version 1.0.1-PL1]]></description>

		<author-notes lang="en"><![CDATA[See the main install file for any additional information about the MOD.
-------------------------------------------------------------------
Before adding this MOD to your forum, you should back up all files related to this MOD.
-------------------------------------------------------------------
On every update make sure you refresh the template and also the browser cache, see DIY instructions at the end of this dodument.
]]></author-notes>

		<author-group>
			<author>
				<realname>Gabriel</realname>
				<username>leviatan21</username>
				<email>info@mssti.com</email>
				<homepage>http://www.mssti.com/phpbb3/</homepage>
				<contributions-group>
					<contributions status="current" from="2010-06-01" position="Developer"/>
				</contributions-group>
			</author>
		</author-group>
		
		<mod-version>1.0.1-PL1</mod-version>

		<installation>
			<level>easy</level>
			<time>120</time>
			<target-version>3.0.7-PL1</target-version>
		</installation>

		<link-group>
			<link type="parent" href="../install_MSSTI_WYSIWYM.xml" lang="en">Code change</link>
		</link-group>

	</header>

	<action-group>
		
		<copy>
			<file from="root/includes/functions_posting_wysiwym.php" to="includes/functions_posting_wysiwym.php" />
			<file from="root/styles/prosilver/template/*.*" to="styles/prosilver/template/*.*" />
		</copy>

		<open src="styles/prosilver/template/editor.js">
			<edit>
				<find><![CDATA[
/** MOD : WYSIWYM editor - Start **/
			wysiwym_editor();
/** MOD : WYSIWYM editor - End **/
]]></find>
				<action type="replace-with"><![CDATA[
/** MOD : WYSIWYM editor (1) - Start **/
			wysiwym_editor();
/** MOD : WYSIWYM editor (1) - End **/
]]></action>
			</edit>

			<edit>
				<find><![CDATA[
/** MOD : WYSIWYM editor - Start **/
		wysiwym_editor();
/** MOD : WYSIWYM editor - End **/
]]></find>
				<action type="replace-with"><![CDATA[
/** MOD : WYSIWYM editor (2) - Start **/
		wysiwym_editor();
/** MOD : WYSIWYM editor (2) - End **/
]]></action>
			</edit>

			<edit>
				<find><![CDATA[
/** MOD : WYSIWYM editor - Start **/
	wysiwym_editor(popup);
/** MOD : WYSIWYM editor - End **/
]]></find>
				<action type="replace-with"><![CDATA[
/** MOD : WYSIWYM editor (3) - Start **/
	wysiwym_editor(popup);
/** MOD : WYSIWYM editor (3) - End **/
]]></action>
			</edit>

			<edit>
				<find><![CDATA[/**
* MOD : WYSIWYM editor - Start
* Chech if the WYSIWYM Markdown editor is available and eventually update it
**/
function wysiwym_editor()
{ 
	if (typeof(WYSIWYM) != 'undefined')
	{
		WYSIWYM.Update();
	}
}
/** MOD : WYSIWYM editor - End **/
]]></find>
				<action type="replace-with"><![CDATA[
/**
* MOD : WYSIWYM editor - Start
* Check if the WYSIWYM Markdown editor is available and eventually update it
**/
function wysiwym_editor(popup)
{
	// Smilies popup
	if (popup)
	{
		if (typeof(opener.WYSIWYM) != 'undefined')
		{
			opener.WYSIWYM.Update();
		}
	}
	else
	{
		if (typeof(WYSIWYM) != 'undefined')
		{
			WYSIWYM.Update();
		}
	}
}
/** MOD : WYSIWYM editor - End **/
]]></action>
			</edit>
		</open>

		<open src="styles/prosilver/template/posting_layout.html">
			<edit>
				<find><![CDATA[<!-- IF S_DISPLAY_PREVIEW --><!-- INCLUDE posting_preview.html --><!-- ENDIF -->]]></find>
				<action type="after-add"><![CDATA[<!-- IF S_LIVE_REVIEW --><!-- INCLUDE posting_wysiwym_preview.html --><!-- ENDIF -->]]></action>
			</edit>
		</open>

		<open src="styles/prosilver/template/posting_pm_layout.html">
			<edit>
				<find><![CDATA[<!-- IF S_DISPLAY_PREVIEW --><!-- INCLUDE posting_preview.html --><!-- ENDIF -->]]></find>
				<action type="after-add"><![CDATA[<!-- IF S_LIVE_REVIEW --><!-- INCLUDE posting_wysiwym_preview.html --><!-- ENDIF -->]]></action>
			</edit>
		</open>

		<open src="styles/prosilver/template/ucp_profile_signature.html">
			<edit>
				<find><![CDATA[		<span class="corners-bottom"><span></span></span></div>
	</div>
<!-- ENDIF -->
]]></find>
				<action type="after-add"><![CDATA[
<!-- IF S_LIVE_REVIEW --><!-- INCLUDE posting_wysiwym_preview.html --><!-- ENDIF -->
]]></action>
			</edit>
		</open>

		<diy-instructions lang="en"><![CDATA[IMPORTANT !

OVERWRITE all your previous files with the new ones!

Please make sure of it, some FTP programs don't do it fine.

Makes sure you follow the DIY instruction in the main install_MSSTI_WYSIWYM.xml file.]]></diy-instructions>

	</action-group>
</mod>